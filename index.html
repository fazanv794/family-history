<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>История моей семьи</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase.js"></script>
    <script src="app.js"></script>
</head>
<body>
    <div id="loader" class="hidden">
        <div id="loader-text">Загрузка...</div>
    </div>
    
    <div id="notification" class="notification hidden">
        <span id="notification-text"></span>
    </div>
    <!-- Шапка (скрыта до авторизации) -->
    <header id="main-header" class="hidden">
        <div class="header-container container">
            <a href="#" class="logo" id="home-link">
                <i class="fas fa-tree"></i>
                История моей семьи
            </a>
            
            <button class="mobile-menu-btn" id="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
            
            <ul class="nav-links" id="nav-links">
                <li><a href="#" id="tree-link">Древо</a></li>
                <li><a href="#" id="timeline-link">Лента событий</a></li>
                <li><a href="#" id="media-link">Медиатека</a></li>
                <li><a href="#" id="profile-link">Мой профиль</a></li>
            </ul>
            
            <div class="user-menu">
                <span id="username">Гость</span>
                <div class="avatar" id="user-avatar">Г</div>
                <button class="btn btn-secondary" style="margin-left: 15px;" id="logout-btn">Выйти</button>
            </div>
        </div>
    </header>

    <!-- Главный контент -->
    <main id="main-content">
        <!-- Новый лендинг -->
        <section id="landing-page" class="page">
            <div class="hero">
                <div class="container">
                    <div class="logo-large">
                        <i class="fas fa-tree"></i>
                        <h1>История моей семьи</h1>
                    </div>
                    <h2>Создайте и сохраните историю вашей семьи</h2>
                    <p>Инструмент для создания генеалогического древа, хранения семейных фотографий и воспоминаний</p>
                    
                    <div class="hero-buttons">
                        <button class="btn btn-primary" id="try-demo-btn">
                            <i class="fas fa-eye"></i> Попробовать демо
                        </button>
                        <button class="btn" id="go-to-auth-btn">
                            <i class="fas fa-sign-in-alt"></i> Войти / Регистрация
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="container">
                <div class="features">
                    <h2>Возможности приложения</h2>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-sitemap"></i>
                            </div>
                            <h3>Генеалогическое древо</h3>
                            <p>Создавайте интерактивное древо с автопостроением, добавляйте родственников, фотографии и биографии.</p>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-images"></i>
                            </div>
                            <h3>Семейный архив</h3>
                            <p>Храните фотографии, видео и документы в одном безопасном месте. Добавляйте фото к каждому родственнику.</p>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <h3>Лента событий</h3>
                            <p>Отмечайте важные семейные события, дни рождения и получайте напоминания.</p>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-print"></i>
                            </div>
                            <h3>Экспорт и печать</h3>
                            <p>Сохраняйте древо в виде картинки, PDF или распечатывайте для семейного архива.</p>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <h3>Совместная работа</h3>
                            <p>Приглашайте родственников для совместного заполнения истории.</p>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <h3>Безопасность</h3>
                            <p>Ваши данные защищены. Только вы и приглашенные родственники имеют доступ.</p>
                        </div>
                    </div>
                    
                    <div class="cta-section">
                        <h3>Начните создавать историю своей семьи сегодня</h3>
                        <p>Присоединяйтесь к тысячам семей, которые сохраняют свои истории</p>
                        <button class="btn btn-large" id="start-now-btn">
                            <i class="fas fa-rocket"></i> Начать сейчас
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Страница авторизации -->
        <section id="auth-page" class="page hidden">
            <div class="auth-container">
                <div class="logo-large">
                    <i class="fas fa-tree"></i>
                    <h1>История моей семьи</h1>
                </div>
                
                <h2 id="auth-title">Вход в аккаунт</h2>
                
                <div class="auth-error" id="auth-error" style="display: none;"></div>
                
                <form class="auth-form" id="auth-form">
                    <div class="form-group">
                        <label for="auth-email">Email</label>
                        <input type="email" id="auth-email" placeholder="Введите ваш email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="auth-password">Пароль</label>
                        <input type="password" id="auth-password" placeholder="Введите пароль" required>
                    </div>
                    
                    <div class="form-group hidden" id="reg-name-group">
                        <label for="auth-name">Имя и фамилия</label>
                        <input type="text" id="auth-name" placeholder="Введите ваше имя">
                    </div>
                    
                    <div class="form-group hidden" id="reg-confirm-group">
                        <label for="auth-confirm-password">Подтверждение пароля</label>
                        <input type="password" id="auth-confirm-password" placeholder="Повторите пароль">
                    </div>
                    
                    <button type="submit" class="btn auth-submit-btn" style="width: 100%; margin-top: 20px;" id="auth-submit">
                        Войти
                    </button>
                </form>
                
                <div class="auth-switch">
                    <p id="auth-switch-text">
                        Нет аккаунта? 
                        <a href="#" id="auth-switch-link">
                            Зарегистрироваться
                        </a>
                    </p>
                </div>
                
                <div class="auth-features">
                    <div class="feature">
                        <i class="fas fa-sitemap"></i>
                        <span>Создавайте генеалогическое древо</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-images"></i>
                        <span>Храните семейные фотографии</span>
                    </div>
                    <div class="feature">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Отмечайте важные даты</span>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Главная страница -->
        <section id="home-page" class="page hidden">
            <div class="hero">
                <div class="container">
                    <h1>Добро пожаловать в вашу семейную историю!</h1>
                    <p>Создайте генеалогическое древо, сохраните воспоминания, фотографии и истории для будущих поколений.</p>
                    <div class="hero-buttons">
                        <button class="btn" id="tree-btn">
                            <i class="fas fa-sitemap"></i> Моё древо
                        </button>
                        <button class="btn btn-secondary" id="add-person-btn">
                            <i class="fas fa-user-plus"></i> Добавить человека
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="container">
                <div class="quick-stats">
                    <div class="stat-card">
                        <i class="fas fa-users"></i>
                        <h3 id="stat-people">0</h3>
                        <p>Людей в древе</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-calendar"></i>
                        <h3 id="stat-events">0</h3>
                        <p>Событий</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-images"></i>
                        <h3 id="stat-media">0</h3>
                        <p>Фотографий</p>
                    </div>
                </div>
                
                <div class="features">
                    <h2>Возможности приложения</h2>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-sitemap"></i>
                            </div>
                            <h3>Генеалогическое древо</h3>
                            <p>Создавайте интерактивное древо, добавляйте родственников, фотографии и биографии.</p>
                            <button class="btn btn-small tree-btn-2">Перейти</button>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-images"></i>
                            </div>
                            <h3>Семейный архив</h3>
                            <p>Храните фотографии, видео и документы в одном безопасном месте.</p>
                            <button class="btn btn-small media-btn-2">Перейти</button>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <h3>События и даты</h3>
                            <p>Отмечайте важные семейные события и получайте напоминания.</p>
                            <button class="btn btn-small timeline-btn-2">Перейти</button>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <h3>Совместная работа</h3>
                            <p>Приглашайте родственников для совместного заполнения истории.</p>
                            <button class="btn btn-small invite-btn-2">Пригласить</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Страница генеалогического древа -->
        <section id="tree-page" class="page hidden">
            <div class="container">
                <div class="page-header">
                    <h2>Мое генеалогическое древо</h2>
                    <div class="tree-actions">
                        <button class="btn" id="auto-tree-btn">
                            <i class="fas fa-magic"></i> Автопостроение
                        </button>
                        <button class="btn" id="add-person-tree-btn">
                            <i class="fas fa-user-plus"></i> Добавить человека
                        </button>
                        <button class="btn btn-secondary" id="print-tree-btn">
                            <i class="fas fa-print"></i> Печать
                        </button>
                        <button class="btn btn-success" id="save-image-btn">
                            <i class="fas fa-camera"></i> Сохранить как картинку
                        </button>
                    </div>
                </div>
                
                <div class="tree-controls">
                    <div class="view-controls">
                        <button class="btn btn-small" id="vertical-view-btn">
                            <i class="fas fa-arrows-alt-v"></i> Вертикально
                        </button>
                        <button class="btn btn-small active" id="horizontal-view-btn">
                            <i class="fas fa-arrows-alt-h"></i> Горизонтально
                        </button>
                        <button class="btn btn-small" id="radial-view-btn">
                            <i class="fas fa-circle"></i> Радиально
                        </button>
                    </div>
                    
                    <div class="zoom-controls">
                        <button class="btn btn-small" id="zoom-in-btn">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button class="btn btn-small" id="zoom-out-btn">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button class="btn btn-small" id="reset-tree-btn">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="btn btn-small" id="fit-tree-btn">
                            <i class="fas fa-compress"></i>
                        </button>
                    </div>
                </div>
                
                <div class="tree-container">
                    <div class="tree" id="family-tree">
                        <div class="tree-empty" id="tree-empty">
                            <i class="fas fa-tree"></i>
                            <h3>Древо пустое</h3>
                            <p>Начните создавать свое семейное древо</p>
                            <div class="empty-buttons">
                                <button class="btn" id="add-person-empty-btn">
                                    <i class="fas fa-user-plus"></i> Добавить первого человека
                                </button>
                                <button class="btn btn-secondary" id="auto-start-btn">
                                    <i class="fas fa-magic"></i> Автопостроение
                                </button>
                            </div>
                        </div>
                        <div id="tree-visualization-container">
                            <svg id="tree-lines" width="100%" height="100%"></svg>
                            <div id="tree-nodes"></div>
                        </div>
                    </div>
                </div>
                
                <div class="tree-stats">
                    <div class="stat">
                        <i class="fas fa-users"></i>
                        <span id="tree-people-count">0</span> человек
                    </div>
                    <div class="stat">
                        <i class="fas fa-arrows-alt-h"></i>
                        <span id="tree-generations">0</span> поколений
                    </div>
                    <div class="stat">
                        <i class="fas fa-camera"></i>
                        <span id="tree-photos-count">0</span> фото
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Лента событий -->
        <section id="timeline-page" class="page hidden">
            <div class="container">
                <div class="page-header">
                    <h2>Лента семейных событий</h2>
                    <button class="btn" id="add-event-btn">
                        <i class="fas fa-plus"></i> Добавить событие
                    </button>
                </div>
                
                <div id="timeline-container">
                    <div class="timeline-empty" id="timeline-empty">
                        <i class="fas fa-calendar-alt"></i>
                        <h3>Пока нет событий</h3>
                        <p>Добавьте первое семейное событие</p>
                        <button class="btn" id="add-event-empty-btn">Добавить событие</button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Медиатека -->
        <section id="media-page" class="page hidden">
            <div class="container">
                <div class="page-header">
                    <h2>Семейная медиатека</h2>
                    <button class="btn" id="upload-media-btn">
                        <i class="fas fa-upload"></i> Загрузить медиа
                    </button>
                </div>
                
                <div class="media-filters">
                    <select id="media-filter">
                        <option value="all">Все файлы</option>
                        <option value="photo">Фотографии</option>
                        <option value="video">Видео</option>
                    </select>
                </div>
                
                <div class="media-grid" id="media-container">
                    <div class="media-empty" id="media-empty">
                        <i class="fas fa-images"></i>
                        <h3>Медиатека пуста</h3>
                        <p>Загрузите первые фотографии вашей семьи</p>
                        <button class="btn" id="upload-media-empty-btn">Загрузить фото</button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Профиль пользователя -->
        <section id="profile-page" class="page hidden">
            <div class="container">
                <div class="page-header">
                    <h2>Мой профиль</h2>
                    <button class="btn" id="edit-profile-btn">
                        <i class="fas fa-edit"></i> Редактировать
                    </button>
                </div>
                
                <div class="profile-container">
                    <div class="profile-sidebar">
                        <div class="profile-avatar" id="profile-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <h3 id="profile-name">Загрузка...</h3>
                        <p id="profile-email">Загрузка...</p>
                        
                        <div class="profile-stats">
                            <div class="stat">
                                <i class="fas fa-users"></i>
                                <span id="profile-stat-people">0</span>
                                <small>Людей</small>
                            </div>
                            <div class="stat">
                                <i class="fas fa-calendar"></i>
                                <span id="profile-stat-events">0</span>
                                <small>Событий</small>
                            </div>
                            <div class="stat">
                                <i class="fas fa-images"></i>
                                <span id="profile-stat-media">0</span>
                                <small>Фото</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="profile-content">
                        <div class="card">
                            <h3>Информация</h3>
                            <div class="info-item">
                                <label>Email:</label>
                                <span id="info-email">Загрузка...</span>
                            </div>
                            <div class="info-item">
                                <label>Дата регистрации:</label>
                                <span id="info-reg-date">Загрузка...</span>
                            </div>
                            <div class="info-item">
                                <label>ID пользователя:</label>
                                <span id="info-user-id" class="user-id">Загрузка...</span>
                            </div>
                        </div>
                        
                        <div class="card">
                            <h3>Настройки</h3>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="setting-birthdays" checked>
                                    Уведомления о днях рождения
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="setting-events" checked>
                                    Уведомления о событиях
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="setting-invites" checked>
                                    Уведомления о приглашениях
                                </label>
                            </div>
                        </div>
                        
                        <div class="card">
                            <h3>О приложении</h3>
                            <p>Версия: 1.0.0</p>
                            <p>Используется Supabase для хранения данных</p>
                            <button class="btn btn-secondary" id="help-btn">
                                <i class="fas fa-question-circle"></i> Помощь
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Подвал -->
    <footer id="main-footer" class="hidden">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-tree"></i> История моей семьи</h4>
                    <p>Создайте и сохраните историю вашей семьи для будущих поколений</p>
                </div>
                
                <div class="footer-section">
                    <h4>Разработчик</h4>
                    <p>Студент [Ваше имя]</p>
                    <p>Дипломный проект 2024</p>
                </div>
                
                <div class="footer-section">
                    <h4>Контакты</h4>
                    <p><i class="fas fa-envelope"></i> familyhistory@example.com</p>
                    <p><i class="fas fa-phone"></i> +7 (XXX) XXX-XX-XX</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 История моей семьи. Все права защищены.</p>
                <p>Дипломный проект по веб-разработке</p>
            </div>
        </div>
    </footer>

    <!-- Модальные окна -->
    <div id="modal-overlay" class="modal-overlay hidden"></div>
    
    <!-- Модальное окно добавления человека -->
    <div id="add-person-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Добавить человека в древо</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-person-form-modal">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="person-first-name">Имя *</label>
                            <input type="text" id="person-first-name" placeholder="Иван" required>
                        </div>
                        <div class="form-group">
                            <label for="person-last-name">Фамилия *</label>
                            <input type="text" id="person-last-name" placeholder="Иванов" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="person-birth-date">Дата рождения</label>
                        <input type="date" id="person-birth-date">
                    </div>
                    
                    <div class="form-group">
                        <label for="person-relation">Кем приходится вам</label>
                        <select id="person-relation">
                            <option value="self">Я</option>
                            <option value="spouse">Супруг/а</option>
                            <option value="parent">Родитель</option>
                            <option value="child">Ребенок</option>
                            <option value="sibling">Брат/сестра</option>
                            <option value="grandparent">Дедушка/бабушка</option>
                            <option value="grandchild">Внук/внучка</option>
                            <option value="other">Другой родственник</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="person-bio">Биография (необязательно)</label>
                        <textarea id="person-bio" rows="3" placeholder="Краткая информация о человеке..."></textarea>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary cancel-btn">
                            Отмена
                        </button>
                        <button type="submit" class="btn">
                            Добавить в древо
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно автопостроения дерева -->
    <div id="auto-tree-modal" class="modal hidden wide">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Автопостроение генеалогического древа</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="auto-tree-form-modal">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="auto-generations">Кол-во поколений</label>
                            <select id="auto-generations">
                                <option value="2">2 поколения (родители + дети)</option>
                                <option value="3" selected>3 поколения (бабушки/дедушки + родители + дети)</option>
                                <option value="4">4 поколения (прабабушки/прадедушки + ...)</option>
                                <option value="5">5 поколений</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="auto-style">Стиль дерева</label>
                            <select id="auto-style">
                                <option value="vertical">Вертикальное (сверху вниз)</option>
                                <option value="horizontal" selected>Горизонтальное (слева направо)</option>
                                <option value="radial">Радиальное (круговое)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="auto-center-person">Центральный человек</label>
                        <select id="auto-center-person">
                            <option value="self">Я (пользователь)</option>
                            <option value="oldest">Самый старший родственник</option>
                            <option value="custom">Выбрать из списка...</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="auto-show-photos" checked>
                            Показывать фотографии
                        </label>
                        <label style="margin-left: 20px;">
                            <input type="checkbox" id="auto-show-dates" checked>
                            Показывать даты
                        </label>
                        <label style="margin-left: 20px;">
                            <input type="checkbox" id="auto-show-lines" checked>
                            Показывать линии связей
                        </label>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary cancel-btn">
                            Отмена
                        </button>
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-magic"></i> Построить дерево
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно редактирования человека -->
    <div id="edit-person-modal" class="modal hidden wide">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Редактирование родственника</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-person-form-modal">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="edit-person-first-name">Имя *</label>
                            <input type="text" id="edit-person-first-name" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-person-last-name">Фамилия *</label>
                            <input type="text" id="edit-person-last-name" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="edit-person-birth-date">Дата рождения</label>
                            <input type="date" id="edit-person-birth-date">
                        </div>
                        <div class="form-group">
                            <label for="edit-person-death-date">Дата смерти (если нет)</label>
                            <input type="date" id="edit-person-death-date">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="edit-person-relation">Связь с вами</label>
                            <select id="edit-person-relation">
                                <option value="self">Я</option>
                                <option value="spouse">Супруг/а</option>
                                <option value="parent">Родитель</option>
                                <option value="child">Ребенок</option>
                                <option value="sibling">Брат/сестра</option>
                                <option value="grandparent">Дедушка/бабушка</option>
                                <option value="grandchild">Внук/внучка</option>
                                <option value="aunt_uncle">Тетя/дядя</option>
                                <option value="cousin">Двоюродный брат/сестра</option>
                                <option value="other">Другой родственник</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-person-gender">Пол</label>
                            <select id="edit-person-gender">
                                <option value="male">Мужской</option>
                                <option value="female">Женский</option>
                                <option value="other">Другой</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-person-photo">Фотография</label>
                        <input type="file" id="edit-person-photo" accept="image/*" class="file-input">
                        <div class="file-hint">Загрузите фотографию родственника</div>
                        <div id="edit-person-photo-preview" class="photo-preview"></div>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-person-bio">Биография</label>
                        <textarea id="edit-person-bio" rows="4" placeholder="Расскажите о жизни родственника..."></textarea>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" id="delete-person-btn">
                            <i class="fas fa-trash"></i> Удалить
                        </button>
                        <button type="button" class="btn btn-secondary cancel-btn">
                            Отмена
                        </button>
                        <button type="submit" class="btn">
                            <i class="fas fa-save"></i> Сохранить изменения
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно добавления события -->
    <div id="add-event-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Добавить семейное событие</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-event-form-modal">
                    <div class="form-group">
                        <label for="event-title">Название события *</label>
                        <input type="text" id="event-title" placeholder="Например: День рождения мамы" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="event-date">Дата события *</label>
                        <input type="date" id="event-date" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="event-description">Описание</label>
                        <textarea id="event-description" rows="3" placeholder="Подробности события..."></textarea>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary cancel-btn">
                            Отмена
                        </button>
                        <button type="submit" class="btn">
                            Добавить событие
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно загрузки медиа -->
    <div id="upload-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Загрузить медиафайлы</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="upload-form-modal">
                    <div class="form-group">
                        <label for="upload-files">Выберите файлы</label>
                        <input type="file" id="upload-files" multiple accept="image/*" class="file-input">
                        <div class="file-hint">Можно выбрать несколько фотографий</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="upload-description">Описание (необязательно)</label>
                        <input type="text" id="upload-description" placeholder="Что на фото?">
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary cancel-btn">
                            Отмена
                        </button>
                        <button type="submit" class="btn">
                            <i class="fas fa-upload"></i> Загрузить
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно приглашения -->
    <div id="invite-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Пригласить родственника</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="invite-form-modal">
                    <div class="form-group">
                        <label for="invite-email">Email родственника *</label>
                        <input type="email" id="invite-email" placeholder="email@example.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="invite-message">Сообщение (необязательно)</label>
                        <textarea id="invite-message" rows="3" placeholder="Привет! Присоединяйся к нашему семейному древу..."></textarea>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary cancel-btn">
                            Отмена
                        </button>
                        <button type="submit" class="btn">
                            Отправить приглашение
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Уведомления -->
    <div id="notification" class="notification hidden">
        <div class="notification-content">
            <span id="notification-text"></span>
            <button class="notification-close">&times;</button>
        </div>
    </div>

    <!-- Загрузчик -->
    <div id="loader" class="loader-overlay hidden">
        <div class="loader"></div>
        <div class="loader-text" id="loader-text">Загрузка...</div>
    </div>

    <!-- Подключаем библиотеки -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- Подключаем наши файлы -->
    <script src="supabase.js"></script>
    <script src="tree-engine.js"></script>
    <script src="app.js"></script>
</body>
</html>