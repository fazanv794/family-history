<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å - –ò—Å—Ç–æ—Ä–∏—è –º–æ–µ–π —Å–µ–º—å–∏</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- –®–∞–ø–∫–∞ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <header id="app-header">
        <div class="header-container container">
            <a href="app.html" class="logo" id="home-link">
                <i class="fas fa-tree"></i>
                –ò—Å—Ç–æ—Ä–∏—è –º–æ–µ–π —Å–µ–º—å–∏
            </a>
            
            <button class="mobile-menu-btn" id="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
            
            <ul class="nav-links" id="nav-links">
                <li><a href="app.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="tree.html">–î—Ä–µ–≤–æ</a></li>
                <li><a href="timeline.html">–õ–µ–Ω—Ç–∞ —Å–æ–±—ã—Ç–∏–π</a></li>
                <li><a href="media.html">–ú–µ–¥–∏–∞—Ç–µ–∫–∞</a></li>
                <li><a href="chats.html">–ß–∞—Ç—ã</a></li>
                <li><a href="profile.html" class="active">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</a></li>
            </ul>
            
            <div class="user-menu">
                <span id="username">–ì–æ—Å—Ç—å</span>
                <div class="avatar" id="user-avatar">–ì</div>
                <button class="btn btn-small" id="logout-btn">–í—ã–π—Ç–∏</button>
            </div>
        </div>
    </header>

    <!-- –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <main id="app-content">
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
        <section id="profile-page" class="page">
            <div class="container">
                <!-- –û–±–Ω–æ–≤–∏–º –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–æ—Ñ–∏–ª—è -->
<div class="profile-container">
    <div class="profile-avatar">
        <div class="avatar large" id="profile-avatar" style="font-size: 3rem; font-weight: bold; display: flex; align-items: center; justify-content: center; color: white; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">–ü</div>
        <h2 id="profile-name">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
        <p id="profile-email">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        <button class="btn btn-small" id="change-avatar-btn" style="margin-top: 15px;">
            <i class="fas fa-camera"></i> –°–º–µ–Ω–∏—Ç—å —Ñ–æ—Ç–æ
        </button>
    </div>
    
    <div class="profile-info">
        <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–∫–∫–∞—É–Ω—Ç–µ</h3>
        <div class="info-grid">
            <div class="info-item">
                <i class="fas fa-envelope"></i>
                <span>Email: <span id="info-email">–ó–∞–≥—Ä—É–∑–∫–∞...</span></span>
            </div>
            <div class="info-item">
                <i class="fas fa-user"></i>
                <span>ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: <span id="info-user-id">–ó–∞–≥—Ä—É–∑–∫–∞...</span></span>
            </div>
            <div class="info-item">
                <i class="fas fa-calendar"></i>
                <span>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: <span id="info-reg-date">–ó–∞–≥—Ä—É–∑–∫–∞...</span></span>
            </div>
            <div class="info-item">
                <i class="fas fa-tree"></i>
                <span>–õ—é–¥–µ–π –≤ –¥—Ä–µ–≤–µ: <span id="info-people-count">0</span></span>
            </div>
        </div>
        
        <!-- –î–æ–±–∞–≤–∏–º —Å–µ–∫—Ü–∏—é –¥–ª—è –¥–µ—Ä–µ–≤–∞ -->
        <h3 style="margin-top: 25px;">–ú–æ–µ –¥–µ—Ä–µ–≤–æ</h3>
        <div id="tree-info-section" style="margin-bottom: 20px;">
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–µ—Ä–µ–≤–µ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
        </div>
        
        <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
        <button class="btn full-width" id="edit-profile-btn">
            <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
        </button>
        <button class="btn btn-secondary full-width" id="invite-btn">
            <i class="fas fa-user-plus"></i> –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞
        </button>
        <button class="btn btn-secondary full-width" id="notifications-settings-btn">
            <i class="fas fa-bell"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        </button>
        <button class="btn btn-outline full-width" id="export-data-btn">
            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
        </button>
        <button class="btn btn-danger full-width" id="logout-profile-btn">
            <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
        </button>
    </div>
</div>
            </div>
        </section>
    </main>

    <!-- –ü–æ–¥–≤–∞–ª -->
    <footer>
        <div class="container">
            <div class="copyright">
                <p>¬© 2025 –ò—Å—Ç–æ—Ä–∏—è –º–æ–µ–π —Å–µ–º—å–∏. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            </div>
        </div>
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div class="modal-overlay hidden" id="modal-overlay"></div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è -->
    <div id="invite-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="invite-form-modal">
                    <div class="form-group">
                        <label for="invite-email">Email —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞ *</label>
                        <input type="email" id="invite-email" placeholder="email@example.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="invite-name">–ò–º—è —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞</label>
                        <input type="text" id="invite-name" placeholder="–ò–º—è">
                    </div>
                    
                    <div class="form-group">
                        <label for="invite-message">–°–æ–æ–±—â–µ–Ω–∏–µ</label>
                        <textarea id="invite-message" rows="4" placeholder="–ü—Ä–∏–≤–µ—Ç! –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ –Ω–∞—à–µ–º—É —Å–µ–º–µ–π–Ω–æ–º—É –¥—Ä–µ–≤—É..."></textarea>
                    </div>
                    
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="invite-editor" checked>
                        <label for="invite-editor">–†–∞–∑—Ä–µ—à–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥—Ä–µ–≤–∞</label>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary cancel-btn">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                        <button type="submit" class="btn">
                            –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è -->
    <div id="edit-profile-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-profile-form-modal">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="edit-profile-name">–ò–º—è *</label>
                            <input type="text" id="edit-profile-name" placeholder="–ò–º—è" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-profile-last-name">–§–∞–º–∏–ª–∏—è</label>
                            <input type="text" id="edit-profile-last-name" placeholder="–§–∞–º–∏–ª–∏—è">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-profile-email">Email *</label>
                        <input type="email" id="edit-profile-email" placeholder="email@example.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-profile-bio">–û —Å–µ–±–µ</label>
                        <textarea id="edit-profile-bio" rows="4" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ..."></textarea>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary cancel-btn">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                        <button type="submit" class="btn">
                            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notification" class="notification">
        <div class="notification-content">
            <span id="notification-text"></span>
            <button class="notification-close">&times;</button>
        </div>
    </div>

    <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
    <div id="loader" class="loader-overlay hidden">
        <div class="loader"></div>
        <div class="loader-text" id="loader-text">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω–∞—à–∏ —Ñ–∞–π–ª—ã -->
    <script src="supabase.js"></script>
    <script src="app.js"></script>
    <script src="profile.js"></script>
    
<!-- –í –∫–æ–Ω—Ü–µ profile.html, –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º —Ç–µ–≥–æ–º body -->
<script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è
    document.addEventListener('DOMContentLoaded', async () => {
        console.log('üë§ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ—Ñ–∏–ª—è...');
        
        // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
        if (typeof window.loadUserData === 'function') {
            await window.loadUserData();
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ—Ñ–∏–ª—å
        if (typeof window.initProfilePage === 'function') {
            window.initProfilePage();
        } else {
            // –ó–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
            setTimeout(() => {
                if (window.currentUser) {
                    updateProfileUI();
                }
            }, 1000);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI (–∑–∞–ø–∞—Å–Ω–∞—è)
        function updateProfileUI() {
            if (!window.currentUser) return;
            
            const name = window.currentUser.user_metadata?.name || 
                        window.currentUser.email?.split('@')[0] || 
                        '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            const email = window.currentUser.email || '–ù–µ —É–∫–∞–∑–∞–Ω';
            const initials = window.getUserInitials ? window.getUserInitials(name) : name.substring(0, 2);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
            document.getElementById('profile-name')?.textContent = name;
            document.getElementById('profile-email')?.textContent = email;
            document.getElementById('profile-avatar')?.textContent = initials;
            document.getElementById('info-email')?.textContent = email;
            document.getElementById('info-user-id')?.textContent = 
                window.currentUser.id ? window.currentUser.id.substring(0, 8) + '...' : '–ù–µ —É–∫–∞–∑–∞–Ω';
        }
    });
</script>
</body>
</html>