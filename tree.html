<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ–∞–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ</title>
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --success-color: #2ecc71;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --info-color: #3498db;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .main-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            margin-top: 20px;
        }
        
        .header-section {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .header-section h1 {
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .header-section .subtitle {
            color: #666;
            font-size: 1.1rem;
        }
        
        .user-info-card {
            background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(67, 97, 238, 0.3);
        }
        
        .user-info-card h3 {
            margin: 0 0 10px 0;
            font-size: 1.5rem;
        }
        
        .user-info-card p {
            margin: 0;
            opacity: 0.9;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: var(--light-color);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid #e9ecef;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .stat-card .stat-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .stat-card .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark-color);
            margin: 10px 0;
        }
        
        .stat-card .stat-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .builder-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px dashed #dee2e6;
        }
        
        .mode-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }
        
        .mode-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .mode-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            border-color: var(--primary-color);
        }
        
        .mode-card.active {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(67, 97, 238, 0.1) 0%, rgba(58, 12, 163, 0.1) 100%);
        }
        
        .mode-card .mode-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        .mode-card.auto .mode-icon {
            color: var(--primary-color);
        }
        
        .mode-card.manual .mode-icon {
            color: var(--warning-color);
        }
        
        .mode-card h3 {
            color: var(--dark-color);
            margin-bottom: 10px;
        }
        
        .mode-card p {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        .feature-list {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .feature-list h4 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .feature-list ul {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
        }
        
        .feature-list li:last-child {
            border-bottom: none;
        }
        
        .feature-list li i {
            color: var(--success-color);
            margin-right: 10px;
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }
        
        .action-btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1rem;
        }
        
        .action-btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }
        
        .action-btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(67, 97, 238, 0.3);
        }
        
        .action-btn-secondary {
            background: var(--light-color);
            color: var(--dark-color);
            border: 2px solid #dee2e6;
        }
        
        .action-btn-secondary:hover {
            background: #e9ecef;
        }
        
        .recent-trees {
            margin-top: 40px;
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .recent-trees h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .tree-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .tree-item {
            background: var(--light-color);
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s;
            border: 1px solid #e9ecef;
            cursor: pointer;
        }
        
        .tree-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .tree-item .tree-name {
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 10px;
        }
        
        .tree-item .tree-info {
            font-size: 0.85rem;
            color: #666;
            display: flex;
            justify-content: space-between;
        }
        
        .help-section {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            border-left: 5px solid var(--info-color);
        }
        
        .help-section h4 {
            color: var(--info-color);
            margin-bottom: 15px;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #dee2e6;
            color: #666;
            font-size: 0.9rem;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .mode-selector {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .main-container {
                padding: 20px;
            }
            
            .header-section h1 {
                font-size: 1.8rem;
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-container fade-in">
            <!-- –®–∞–ø–∫–∞ -->
            <div class="header-section">
                <h1>üå≥ –ì–µ–Ω–µ–∞–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –î–µ—Ä–µ–≤–æ</h1>
                <p class="subtitle">–°–æ–∑–¥–∞–π—Ç–µ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∏—Å—Ç–æ—Ä–∏—é –≤–∞—à–µ–π —Å–µ–º—å–∏</p>
            </div>
            
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
            <div class="user-info-card">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h3 id="user-name">–ó–∞–≥—Ä—É–∑–∫–∞...</h3>
                        <p id="user-email"></p>
                    </div>
                    <div class="col-md-4 text-end">
                        <button class="btn btn-light" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-number" id="stat-relatives">0</div>
                    <div class="stat-label">–†–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-tree"></i>
                    </div>
                    <div class="stat-number" id="stat-trees">0</div>
                    <div class="stat-label">–î–µ—Ä–µ–≤—å–µ–≤ —Å–æ–∑–¥–∞–Ω–æ</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-history"></i>
                    </div>
                    <div class="stat-number" id="stat-depth">0</div>
                    <div class="stat-label">–ü–æ–∫–æ–ª–µ–Ω–∏–π</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div class="stat-number" id="stat-years">0</div>
                    <div class="stat-label">–õ–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏</div>
                </div>
            </div>
            
            <!-- –°–µ–∫—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—è -->
            <div class="builder-section">
                <h2 class="text-center mb-4">üõ†Ô∏è –ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å –î–µ—Ä–µ–≤–∞</h2>
                <p class="text-center mb-4">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≤–∞—à–µ–≥–æ –≥–µ–Ω–µ–∞–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –¥–µ—Ä–µ–≤–∞:</p>
                
                <div class="mode-selector">
                    <div class="mode-card auto active" id="auto-mode" onclick="selectMode('auto')">
                        <div class="mode-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <h3>–ê–≤—Ç–æ-–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ</h3>
                        <p>–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ–¥–µ—Ç –≤–∞—Å —á–µ—Ä–µ–∑ –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å —à–∞–≥ –∑–∞ —à–∞–≥–æ–º. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤!</p>
                        <div class="badge bg-primary">–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è</div>
                    </div>
                    
                    <div class="mode-card manual" id="manual-mode" onclick="selectMode('manual')">
                        <div class="mode-icon">
                            <i class="fas fa-edit"></i>
                        </div>
                        <h3>–†—É—á–Ω–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ</h3>
                        <p>–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫–∞–∂–¥—ã–º —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–º –∏ —Å–≤—è–∑—è–º–∏. –î–ª—è –æ–ø—ã—Ç–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</p>
                        <div class="badge bg-warning text-dark">–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π</div>
                    </div>
                </div>
                
                <div class="feature-list">
                    <h4><i class="fas fa-check-circle"></i> –ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:</h4>
                    <ul>
                        <li><i class="fas fa-check"></i> –ü–æ—à–∞–≥–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏</li>
                        <li><i class="fas fa-check"></i> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π –∏ –ø–æ–∫–æ–ª–µ–Ω–∏–π</li>
                        <li><i class="fas fa-check"></i> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–µ—Ä–µ–≤–∞ –≤ 4 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç–∏–ª—è—Ö</li>
                        <li><i class="fas fa-check"></i> –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ PNG, PDF –∏ JSON</li>
                        <li><i class="fas fa-check"></i> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–µ—Ä–µ–≤—å–µ–≤ –≤ –≤–∞—à–µ–º –∞–∫–∫–∞—É–Ω—Ç–µ</li>
                        <li><i class="fas fa-check"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è</li>
                    </ul>
                </div>
                
                <div class="text-center mt-4">
                    <button class="action-btn action-btn-primary pulse" id="start-builder-btn" 
                            onclick="startTreeBuilder()" style="padding: 20px 40px; font-size: 1.2rem;">
                        <i class="fas fa-play-circle"></i> –ù–∞—á–∞—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞
                    </button>
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn action-btn-secondary" onclick="loadSampleTree()">
                        <i class="fas fa-eye"></i> –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–º–µ—Ä
                    </button>
                    <button class="action-btn action-btn-secondary" onclick="openTutorial()">
                        <i class="fas fa-graduation-cap"></i> –û–±—É—á–µ–Ω–∏–µ
                    </button>
                    <button class="action-btn action-btn-secondary" onclick="importTree()">
                        <i class="fas fa-file-import"></i> –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                    </button>
                    <button class="action-btn action-btn-secondary" onclick="exportAllData()">
                        <i class="fas fa-file-export"></i> –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
                    </button>
                </div>
            </div>
            
            <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ—Ä–µ–≤—å—è -->
            <div class="recent-trees">
                <h3><i class="fas fa-history"></i> –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ—Ä–µ–≤—å—è</h3>
                <div class="tree-list" id="recent-trees-list">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –¥–µ—Ä–µ–≤—å—è -->
                    <div class="text-center py-5">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                        </div>
                        <p class="mt-3">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –¥–µ—Ä–µ–≤—å–µ–≤...</p>
                    </div>
                </div>
            </div>
            
            <!-- –°–ø—Ä–∞–≤–∫–∞ -->
            <div class="help-section">
                <h4><i class="fas fa-question-circle"></i> –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?</h4>
                <p>–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ —Å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ–º –¥–µ—Ä–µ–≤–∞ –∏–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã:</p>
                <div class="mt-3">
                    <button class="btn btn-info me-2" onclick="openHelp()">
                        <i class="fas fa-question-circle"></i> –°–ø—Ä–∞–≤–∫–∞
                    </button>
                    <button class="btn btn-outline-info" onclick="contactSupport()">
                        <i class="fas fa-headset"></i> –ü–æ–¥–¥–µ—Ä–∂–∫–∞
                    </button>
                </div>
            </div>
            
            <!-- –§—É—Ç–µ—Ä -->
            <div class="footer">
                <p>üå≥ –ì–µ–Ω–µ–∞–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –î–µ—Ä–µ–≤–æ ¬© 2024 | –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ-–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è v2.0</p>
                <p class="text-muted">–í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã –∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ</p>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="supabase.js"></script>
    <script src="app.js"></script>
    
    <!-- –°–∏—Å—Ç–µ–º–∞ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω -->
    <script src="modal-system.js"></script>
    
    <!-- –ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å –¥–µ—Ä–µ–≤–∞ -->
    <script src="tree-builder.js"></script>
    
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üå≥ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–µ—Ä–µ–≤–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è...');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            checkAuth();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            loadStatistics();
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –¥–µ—Ä–µ–≤—å–µ–≤
            loadRecentTrees();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
            initEventHandlers();
            
            console.log('‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–µ—Ä–µ–≤–∞ –≥–æ—Ç–æ–≤–∞');
        });
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        async function checkAuth() {
            try {
                const { data: { user } } = await supabase.auth.getUser();
                if (user) {
                    document.getElementById('user-name').textContent = user.user_metadata?.full_name || user.email;
                    document.getElementById('user-email').textContent = user.email;
                } else {
                    window.location.href = 'index.html';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);
                window.location.href = 'index.html';
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        async function loadStatistics() {
            try {
                const { data: relatives } = await supabase
                    .from('relatives')
                    .select('*');
                
                const { data: trees } = await supabase
                    .from('trees')
                    .select('*');
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                document.getElementById('stat-relatives').textContent = relatives?.length || 0;
                document.getElementById('stat-trees').textContent = trees?.length || 0;
                
                // –†–∞—Å—á–µ—Ç –ø–æ–∫–æ–ª–µ–Ω–∏–π (–ø—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞)
                if (relatives && relatives.length > 0) {
                    const birthYears = relatives
                        .map(r => new Date(r.birth_date).getFullYear())
                        .filter(year => !isNaN(year));
                    
                    if (birthYears.length > 0) {
                        const minYear = Math.min(...birthYears);
                        const maxYear = Math.max(...birthYears);
                        const yearsDiff = maxYear - minYear;
                        
                        document.getElementById('stat-years').textContent = yearsDiff;
                        
                        // –ü—Ä–æ—Å—Ç–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ–∫–æ–ª–µ–Ω–∏–π (–∫–∞–∂–¥—ã–µ 25 –ª–µ—Ç)
                        document.getElementById('stat-depth').textContent = Math.ceil(yearsDiff / 25) || 1;
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–µ—Ä–µ–≤—å–µ–≤
        async function loadRecentTrees() {
            try {
                const { data: trees, error } = await supabase
                    .from('trees')
                    .select('*')
                    .order('created_at', { ascending: false })
                    .limit(4);
                
                const container = document.getElementById('recent-trees-list');
                
                if (error) throw error;
                
                if (!trees || trees.length === 0) {
                    container.innerHTML = `
                        <div class="col-12 text-center py-5">
                            <div class="text-muted">
                                <i class="fas fa-tree fa-3x mb-3"></i>
                                <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –¥–µ—Ä–µ–≤—å–µ–≤</p>
                                <button class="btn btn-primary" onclick="startTreeBuilder()">
                                    –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤–æ–µ –¥–µ—Ä–µ–≤–æ
                                </button>
                            </div>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = trees.map(tree => `
                    <div class="tree-item" onclick="openTree('${tree.id}')">
                        <div class="tree-name">${tree.name}</div>
                        <div class="tree-info">
                            <span>${tree.relatives_count || 0} —Ä–æ–¥.</span>
                            <span>${new Date(tree.created_at).toLocaleDateString('ru-RU')}</span>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ä–µ–≤—å–µ–≤:', error);
                document.getElementById('recent-trees-list').innerHTML = `
                    <div class="col-12 text-center py-5 text-danger">
                        <i class="fas fa-exclamation-triangle fa-2x mb-3"></i>
                        <p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ä–µ–≤—å–µ–≤</p>
                    </div>
                `;
            }
        }
        
        // –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞
        function selectMode(mode) {
            const autoMode = document.getElementById('auto-mode');
            const manualMode = document.getElementById('manual-mode');
            const startBtn = document.getElementById('start-builder-btn');
            
            if (mode === 'auto') {
                autoMode.classList.add('active');
                manualMode.classList.remove('active');
                startBtn.innerHTML = '<i class="fas fa-bolt"></i> –ù–∞—á–∞—Ç—å –∞–≤—Ç–æ-–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ';
            } else {
                manualMode.classList.remove('active');
                autoMode.classList.add('active');
                startBtn.innerHTML = '<i class="fas fa-edit"></i> –ù–∞—á–∞—Ç—å —Ä—É—á–Ω–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ';
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä –≤ localStorage
            localStorage.setItem('tree-builder-mode', mode);
        }
        
        // –ó–∞–ø—É—Å–∫ –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—è –¥–µ—Ä–µ–≤–∞
        function startTreeBuilder() {
            const mode = localStorage.getItem('tree-builder-mode') || 'auto';
            
            console.log(`üöÄ –ó–∞–ø—É—Å–∫ –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—è –≤ —Ä–µ–∂–∏–º–µ: ${mode}`);
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ tree-builder.js
            if (typeof window.startTreeBuilder === 'function') {
                window.startTreeBuilder(mode);
            } else {
                console.error('–§—É–Ω–∫—Ü–∏—è startTreeBuilder –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
                alert('–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
            }
        }
        
        // –û—Ç–∫—Ä—ã—Ç—å –¥–µ—Ä–µ–≤–æ
        function openTree(treeId) {
            alert(`–û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Ä–µ–≤–∞ ${treeId} - —Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ`);
            // –í –±—É–¥—É—â–µ–º: window.openTreeViewer(treeId);
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–º–µ—Ä –¥–µ—Ä–µ–≤–∞
        function loadSampleTree() {
            window.ModalSystem.createModal('sample-tree', {
                title: 'üëÅÔ∏è –ü—Ä–∏–º–µ—Ä –≥–µ–Ω–µ–∞–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –¥–µ—Ä–µ–≤–∞',
                content: `
                    <div style="text-align:center;">
                        <div style="font-family:monospace;font-size:12px;background:#f8f9fa;padding:20px;border-radius:10px;margin:20px 0;">
                            <pre>
        –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ (1950)
            |
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ           ‚îÇ
    –ü—ë—Ç—Ä –ò–≤–∞–Ω–æ–≤    –ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞
    (1975)         (1978)
        |               |
    ‚îå‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ       ‚îÇ       ‚îÇ       ‚îÇ
–ê–ª–µ–∫—Å–µ–π   –û–ª—å–≥–∞   –î–º–∏—Ç—Ä–∏–π  –ê–Ω–Ω–∞
(2000)   (2002)   (2005)  (2008)
                            </pre>
                        </div>
                        <p>–≠—Ç–æ –ø—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≥–µ–Ω–µ–∞–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –¥–µ—Ä–µ–≤–∞</p>
                        <div class="mt-4">
                            <button class="btn btn-primary" onclick="window.ModalSystem.closeModal('sample-tree'); startTreeBuilder();">
                                –°–æ–∑–¥–∞—Ç—å –ø–æ–¥–æ–±–Ω–æ–µ –¥–µ—Ä–µ–≤–æ
                            </button>
                        </div>
                    </div>
                `,
                width: '500px'
            });
        }
        
        // –û—Ç–∫—Ä—ã—Ç—å –æ–±—É—á–µ–Ω–∏–µ
        function openTutorial() {
            window.ModalSystem.createModal('tutorial', {
                title: 'üéì –û–±—É—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–µ —Å –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª–µ–º',
                content: `
                    <div style="max-height:400px;overflow-y:auto;">
                        <h4>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ-–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ:</h4>
                        <ol>
                            <li><strong>–®–∞–≥ 1:</strong> –í—ã–±–µ—Ä–∏—Ç–µ –ª–∏–Ω–∏—é —Ä–æ–¥—Å—Ç–≤–∞ (–æ—Ç—Ü–∞, –º–∞—Ç–µ—Ä–∏ –∏–ª–∏ –æ–±–µ)</li>
                            <li><strong>–®–∞–≥ 2:</strong> –î–æ–±–∞–≤–ª—è–π—Ç–µ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω—É—é —Ñ–æ—Ä–º—É</li>
                            <li><strong>–®–∞–≥ 3:</strong> –ó–∞–ø–æ–ª–Ω—è–π—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é: –§–ò–û, –¥–∞—Ç—ã, —Ñ–æ—Ç–æ, —Ä–æ–ª—å</li>
                            <li><strong>–®–∞–≥ 4:</strong> –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º–∏</li>
                            <li><strong>–®–∞–≥ 5:</strong> –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –¥–µ—Ä–µ–≤–∞</li>
                            <li><strong>–®–∞–≥ 6:</strong> –ü–æ–ª—É—á–∏—Ç–µ –≥–æ—Ç–æ–≤–æ–µ –¥–µ—Ä–µ–≤–æ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –µ–≥–æ</li>
                        </ol>
                        
                        <h4 class="mt-4">–°–æ–≤–µ—Ç—ã:</h4>
                        <ul>
                            <li>–ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –±–ª–∏–∂–∞–π—à–∏—Ö —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ (—Ä–æ–¥–∏—Ç–µ–ª–∏, –±–∞–±—É—à–∫–∏/–¥–µ–¥—É—à–∫–∏)</li>
                            <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¥–ª—è –ª—É—á—à–µ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏</li>
                            <li>–ó–∞–ø–æ–ª–Ω—è–π—Ç–µ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø–æ–∫–æ–ª–µ–Ω–∏–π</li>
                            <li>–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
                        </ul>
                        
                        <div class="alert alert-info mt-4">
                            <i class="fas fa-lightbulb"></i> 
                            <strong>–°–æ–≤–µ—Ç:</strong> –î–ª—è –Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≤—Ç–æ-–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ - –æ–Ω–æ –ø—Ä–æ—â–µ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤!
                        </div>
                    </div>
                `,
                width: '600px',
                buttons: [
                    {
                        text: '–ó–∞–∫—Ä—ã—Ç—å',
                        type: 'secondary'
                    },
                    {
                        text: '–ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ',
                        type: 'primary',
                        onClick: () => {
                            window.ModalSystem.closeModal('tutorial');
                            setTimeout(() => startTreeBuilder(), 300);
                        }
                    }
                ]
            });
        }
        
        // –ò–º–ø–æ—Ä—Ç –¥–µ—Ä–µ–≤–∞
        function importTree() {
            window.ModalSystem.createModal('import-tree', {
                title: 'üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö',
                content: `
                    <div>
                        <p>–í—ã –º–æ–∂–µ—Ç–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞—Ö –∏–∑:</p>
                        <div class="mt-3">
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="radio" name="importType" id="importJson" checked>
                                <label class="form-check-label" for="importJson">
                                    JSON —Ñ–∞–π–ª (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="radio" name="importType" id="importGedcom">
                                <label class="form-check-label" for="importGedcom">
                                    GEDCOM —Ñ–∞–π–ª (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –≥–µ–Ω–µ–∞–ª–æ–≥–∏–∏)
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="radio" name="importType" id="importCsv">
                                <label class="form-check-label" for="importCsv">
                                    CSV/Excel —Ç–∞–±–ª–∏—Ü–∞
                                </label>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <div class="mb-3">
                                <label class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª:</label>
                                <input type="file" class="form-control" id="importFile" accept=".json,.ged,.csv,.xlsx">
                            </div>
                            
                            <div class="alert alert-warning">
                                <i class="fas fa-exclamation-triangle"></i>
                                <strong>–í–Ω–∏–º–∞–Ω–∏–µ:</strong> –ò–º–ø–æ—Ä—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é.
                            </div>
                        </div>
                    </div>
                `,
                width: '500px',
                buttons: [
                    {
                        text: '–û—Ç–º–µ–Ω–∞',
                        type: 'secondary'
                    },
                    {
                        text: '–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å',
                        type: 'primary',
                        onClick: () => {
                            alert('–§—É–Ω–∫—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
                            window.ModalSystem.closeModal('import-tree');
                        }
                    }
                ]
            });
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        function exportAllData() {
            window.ModalSystem.createModal('export-data', {
                title: 'üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö',
                content: `
                    <div>
                        <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤—Å–µ—Ö –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö:</p>
                        <div class="mt-3">
                            <button class="btn btn-outline-primary w-100 mb-2" onclick="exportFormat('json')">
                                <i class="fas fa-file-code"></i> JSON (–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
                            </button>
                            <button class="btn btn-outline-success w-100 mb-2" onclick="exportFormat('pdf')">
                                <i class="fas fa-file-pdf"></i> PDF –¥–æ–∫—É–º–µ–Ω—Ç
                            </button>
                            <button class="btn btn-outline-info w-100 mb-2" onclick="exportFormat('png')">
                                <i class="fas fa-image"></i> PNG –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                            </button>
                            <button class="btn btn-outline-secondary w-100" onclick="exportFormat('csv')">
                                <i class="fas fa-file-csv"></i> CSV —Ç–∞–±–ª–∏—Ü–∞
                            </button>
                        </div>
                        
                        <div class="alert alert-info mt-4">
                            <i class="fas fa-info-circle"></i>
                            JSON —Ñ–æ—Ä–º–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.
                        </div>
                    </div>
                `,
                width: '450px'
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
        function exportFormat(format) {
            window.ModalSystem.closeModal('export-data');
            
            switch(format) {
                case 'json':
                    alert('–≠–∫—Å–ø–æ—Ä—Ç –≤ JSON - —Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
                    break;
                case 'pdf':
                    alert('–≠–∫—Å–ø–æ—Ä—Ç –≤ PDF - —Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
                    break;
                case 'png':
                    alert('–≠–∫—Å–ø–æ—Ä—Ç –≤ PNG - —Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
                    break;
                case 'csv':
                    alert('–≠–∫—Å–ø–æ—Ä—Ç –≤ CSV - —Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
                    break;
            }
        }
        
        // –û—Ç–∫—Ä—ã—Ç—å —Å–ø—Ä–∞–≤–∫—É
        function openHelp() {
            window.open('help.html', '_blank');
        }
        
        // –°–≤—è–∑–∞—Ç—å—Å—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
        function contactSupport() {
            window.location.href = 'mailto:support@example.com?subject=–ü–æ–º–æ—â—å —Å –≥–µ–Ω–µ–∞–ª–æ–≥–∏—á–µ—Å–∫–∏–º –¥–µ—Ä–µ–≤–æ–º';
        }
        
        // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        async function logout() {
            try {
                const { error } = await supabase.auth.signOut();
                if (error) throw error;
                
                window.location.href = 'index.html';
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function initEventHandlers() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
            const savedMode = localStorage.getItem('tree-builder-mode') || 'auto';
            selectMode(savedMode);
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ
            document.getElementById('auto-mode').addEventListener('click', () => selectMode('auto'));
            document.getElementById('manual-mode').addEventListener('click', () => selectMode('manual'));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É —Å—Ç–∞—Ä—Ç–∞
            const startBtn = document.getElementById('start-builder-btn');
            startBtn.addEventListener('mouseenter', function() {
                this.classList.remove('pulse');
            });
            
            startBtn.addEventListener('mouseleave', function() {
                this.classList.add('pulse');
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(loadStatistics, 30000);
            
            console.log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏
        window.treePage = {
            refreshStats: loadStatistics,
            refreshTrees: loadRecentTrees,
            startBuilder: startTreeBuilder,
            openSample: loadSampleTree,
            openTutorial: openTutorial
        };
        
        console.log('üå≥ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–µ—Ä–µ–≤–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
        console.log('–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:', Object.keys(window.treePage));
    </script>
</body>
</html>